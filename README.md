# MD Manual Tool

一个用于生成Markdown文档的工具，支持模板渲染、版本号管理和图片处理。

## 功能特性

- 📝 **模板渲染**：支持使用Go模板语法渲染Markdown文档
- 🔄 **版本号管理**：自动从模板文件名提取版本号，支持版本号替换
- 🖼️ **图片处理**：自动复制和更新文档中的图片路径
- ⚙️ **配置管理**：支持YAML配置文件，可自定义变量
- 🎯 **智能命名**：保持产品名称，自动替换版本号生成输出文件名
- 🏗️ **模块化设计**：高度模块化的代码结构，便于维护和扩展

## 项目结构

```
md-manual-tool/
├── main.go                 # 主程序入口（简化后）
├── pkg/
│   ├── config/
│   │   ├── config.go       # 配置读取和管理
│   │   ├── config_test.go  # 配置测试
│   │   └── manager.go      # 配置管理器（新增）
│   ├── constants/
│   │   └── constants.go    # 常量定义
│   ├── document/
│   │   └── processor.go    # 文档处理器（新增）
│   ├── input/
│   │   └── collector.go    # 输入收集器（新增）
│   ├── processor/
│   │   └── processor.go    # 核心处理器
│   ├── template/
│   │   └── template.go     # 模板渲染引擎
│   ├── ui/
│   │   └── interface.go    # UI交互接口（新增）
│   ├── utils/
│   │   ├── utils.go        # 通用工具函数
│   │   └── version.go      # 版本号处理工具
│   └── validator/
│       └── validator.go    # 输入验证器（新增）
├── templates/              # 模板文件目录
├── configs/                # 配置文件目录
└── output/                 # 输出文件目录
```

## 模块化设计

### 1. 输入收集模块 (`pkg/input/`)
- **Collector**: 负责收集用户输入
- **InputData**: 输入数据结构
- 功能：收集模板路径、配置文件路径、版本号

### 2. 验证模块 (`pkg/validator/`)
- **Validator**: 输入验证器
- **ValidationResult**: 验证结果结构
- 功能：验证文件存在性、版本号格式

### 3. 配置管理模块 (`pkg/config/`)
- **Manager**: 配置管理器
- **ConfigData**: 配置数据结构
- 功能：加载配置、处理版本号、生成输出路径

### 4. 文档处理模块 (`pkg/document/`)
- **Processor**: 文档处理器
- 功能：协调各个模块处理文档生成

### 5. UI交互模块 (`pkg/ui/`)
- **Interface**: UI交互接口
- 功能：显示成功信息、错误信息、进度信息

### 6. 版本号工具模块 (`pkg/utils/`)
- **VersionUtils**: 版本号处理工具
- 功能：提取版本号、生成输出文件名、验证格式

## 代码优化特性

### 1. 高度模块化
- **单一职责原则**：每个模块只负责特定功能
- **依赖注入**：通过构造函数注入依赖
- **接口分离**：清晰的模块间接口定义

### 2. 错误处理
- **统一错误处理**：使用常量定义错误消息
- **错误链传递**：保持错误上下文信息
- **用户友好**：提供清晰的错误提示

### 3. 配置管理
- **常量集中管理**：所有消息和配置常量统一管理
- **版本号验证**：支持版本号格式验证
- **默认值处理**：智能处理默认配置

### 4. 代码可维护性
- **函数职责单一**：每个函数只负责一个功能
- **命名规范**：使用清晰的函数和变量命名
- **注释完整**：提供详细的中文注释

### 5. 可扩展性
- **插件化设计**：新功能可以轻松添加到相应模块
- **测试友好**：模块化设计便于单元测试
- **配置灵活**：支持多种配置方式

## 使用方法

### 1. 准备模板文件
创建包含版本号的模板文件，例如：
```
templates/易立德产品数据管理软件(eRDCloud-PDM)部署手册_3.2.0.md
```

### 2. 准备配置文件
创建YAML配置文件，例如：
```yaml
# config.yaml
产品名称: 易立德产品数据管理软件
公司名称: 易立德科技
```

### 3. 运行程序
```bash
go run main.go
```

### 4. 按提示输入
```
请输入模板文件路径（如 templates/template.md）：templates/易立德产品数据管理软件(eRDCloud-PDM)部署手册_3.2.0.md
检测到模板文件中的版本号：3.2.0
请输入配置文件路径（如 D:/config.yaml，直接回车则使用工具的当前目录的config.yaml）：
使用默认配置文件：config.yaml
请输入版本号（如 1.0.1）：3.1.0
版本参数已添加：3.1.0
文件生成成功！输出路径：易立德产品数据管理软件(eRDCloud-PDM)部署手册_3.1.0.md
```

## 版本号处理

### 支持的格式
- 模板文件名：`产品名称_版本号.md`
- 版本号格式：`x.y.z`（如 1.0.1）

### 自动替换
程序会自动替换模板内容中的以下版本号格式：
- `3.2.0` → `3.1.0`
- `v3.2.0` → `v3.1.0`
- `版本 3.2.0` → `版本 3.1.0`
- `Version 3.2.0` → `Version 3.1.0`
- `版本号：3.2.0` → `版本号：3.1.0`
- `Version: 3.2.0` → `Version: 3.1.0`

## 开发指南

### 添加新功能
1. 在相应的模块中创建新文件
2. 在`constants.go`中定义相关常量
3. 在相应的模块中添加功能
4. 更新测试文件

### 代码规范
- 使用中文注释
- 函数名使用驼峰命名
- 错误处理要完整
- 添加适当的日志输出
- 遵循单一职责原则

### 模块扩展
- **新增输入类型**：在`input`模块中添加新的收集器
- **新增验证规则**：在`validator`模块中添加新的验证器
- **新增UI组件**：在`ui`模块中添加新的界面组件
- **新增处理逻辑**：在`document`模块中添加新的处理器

## 构建和运行

### 构建
```bash
go build -o md-manual-tool.exe
```

### 运行
```bash
./md-manual-tool.exe
```

## 许可证

MIT License 